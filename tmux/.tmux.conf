# =========================
#     Modern Tmux Setup
# =========================

# --- TPM Plugin Manager ---
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'catppuccin/tmux'

# --- General Settings ---
set -g prefix C-a                      # Easier than C-b
unbind C-b
bind C-a send-prefix

set -g mouse on                        # Full mouse support
set -g history-limit 10000             # Scrollback
set -g base-index 1                    # Start windows at 1
setw -g pane-base-index 1              # Panes start at 1
set -g renumber-windows on             # Auto renumber on close
set -g default-terminal "tmux-256color"
set -as terminal-overrides ',xterm-256color:RGB'

# --- Status Bar / Theme ---
set -g @catppuccin_flavor "mocha"
set -g @catppuccin_window_status_style "rounded"

# --- Pane Navigation (works with Vim splits) ---
bind -n C-h if-shell '[[ "$(tmux display-message -p "#{pane_current_command}")" =~ n?vim ]]' \
  'send-keys C-h' 'select-pane -L'
bind -n C-j if-shell '[[ "$(tmux display-message -p "#{pane_current_command}")" =~ n?vim ]]' \
  'send-keys C-j' 'select-pane -D'
bind -n C-k if-shell '[[ "$(tmux display-message -p "#{pane_current_command}")" =~ n?vim ]]' \
  'send-keys C-k' 'select-pane -U'
bind -n C-l if-shell '[[ "$(tmux display-message -p "#{pane_current_command}")" =~ n?vim ]]' \
  'send-keys C-l' 'select-pane -R'
bind -n C-\\ if-shell '[[ "$(tmux display-message -p "#{pane_current_command}")" =~ n?vim ]]' \
  'send-keys C-\\' 'select-pane -l'


# --- Quality of Life ---
setw -g mode-keys vi
set -g status-keys vi
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection-and-cancel
bind r source-file ~/.tmux.conf \; display "Reloaded tmux.conf ✅"

# --- Splitting Panes ---
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# --- Window Management ---
bind c new-window -c "#{pane_current_path}"
bind & confirm-before -p "Kill window #W? (y/n)" kill-window

# --- Session Management ---
bind s choose-tree -Z
bind $ command-prompt -I "#S" "rename-session '%%'"
bind w command-prompt -I "#W" "rename-window '%%'"

# --- Resize with Alt + Arrows ---
bind -n M-Left resize-pane -L 2
bind -n M-Right resize-pane -R 2
bind -n M-Up resize-pane -U 1
bind -n M-Down resize-pane -D 1

# --- Elegant Status Bar Layout ---
set -g status on
set -g status-interval 5
set -g status-justify left

# Left: session name
set -g status-left-length 40
set -g status-left '#[fg=#89b4fa,bold] #S #[default]'

# Windows: index:name, highlighted current one
set -g window-status-format ' #[fg=#a6adc8]#I:#W '
set -g window-status-current-format '#[fg=#1e1e2e,bg=#89b4fa,bold] #I:#W #[default]'

# Right
set -g status-right-length 40
set -g status-right '#[fg=#a6adc8]#(date +"%H:%M") #[fg=#f5c2e7]| #(date +"%d %b") #[default]'

# General appearance
set -g status-bg "#1e1e2e"
set -g status-fg "#cdd6f4"
set -g message-style "bg=#89b4fa,fg=#1e1e2e"
set -g pane-border-style "fg=#45475a"
set -g pane-active-border-style "fg=#89b4fa"

# Optional: make inactive windows dim
setw -g window-status-current-style "bold"
setw -g window-status-activity-style "underscore"
setw -g window-status-bell-style "fg=#f38ba8,bg=#1e1e2e,bold"
set -g status-left '#[fg=#89b4fa,bg=#1e1e2e]#[fg=#1e1e2e,bg=#89b4fa,bold] #S #[fg=#89b4fa,bg=#1e1e2e]#[default]'

# --- Window Renaming Fix ---
# Disable tmux automatic renaming
set -g allow-rename off
set -g automatic-rename off

# Force Catppuccin to use the actual tmux window name
set -g @catppuccin_window_text '#W'
set -g @catppuccin_window_current_text '#W'

# Window status format
set -g window-status-format ' #I:#W '
set -g window-status-current-format '#[bg=#89b4fa,fg=#1e1e2e,bold] #I:#W #[default]'




# --- TPM initialization ---
run '~/.tmux/plugins/tpm/tpm'



